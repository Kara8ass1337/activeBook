{"version":3,"sources":["webpack:///webpack/bootstrap b1e941f6687557696c98","webpack:///./new_view/js/custom/ConstsDOM.js","webpack:///./new_view/js/custom/PopoverControl.js","webpack:///./new_view/js/custom/js.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;AChEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;ACXA;AAAA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;;AAEA;AACA;AACA,2BAA2B;AAC3B,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA,iCAAiC;AACjC,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA,8BAA8B;AAC9B,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;;AAEA;AACA;AACA,8BAA8B;AAC9B,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,8BAA8B;AAC9B,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,sBAAsB,2CAA2C;;AAEjE;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0BAA0B,iEAAiE;AAC3F,SAAS;AACT;;AAEA,0BAA0B,+DAA+D;AACzF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;;AAEA;AACA;AACA,8BAA8B;AAC9B,wBAAwB;AACxB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,C;;;;;;;;;;;;ACrOA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAqB,iBAAiB;AACtC;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,yBAAyB,oBAAoB;AAC7C;;AAEA;AACA,6BAA6B,iBAAiB;AAC9C,aAAa;;AAEb;AACA;;AAEA;;AAEA;AACA;AACA,SAAS;AACT;AACA;;AAEA;;AAEA;AACA,KAAK;AACL,CAAC,E","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b1e941f6687557696c98","export default class ConstsDOM {\n    constructor () {\n\n    }\n\n    static get () {\n        return {\n            $text: $('.text'),\n            $tableOfContents: $('.table-of-contents')\n        }\n    }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./new_view/js/custom/ConstsDOM.js\n// module id = 0\n// module chunks = 0","/**\n * управляем отображением поповеров\n */\nimport ConstsDom from './ConstsDOM';\nexport default class PopoverControl {\n    constructor () {\n\n    }\n\n    /**\n     *\n     * @param $popoversParents[] {object}\n     */\n    static init ($popoversParents) {\n        $popoversParents.each(function (index, popoverParent) {\n            $(popoverParent).find('.obj-img__wrapper').on('click', function (e) {\n                e.preventDefault();\n                e.stopPropagation();\n\n                let $triggerButton = $(this);\n                let $popover = $(popoverParent).find('.add-settings');\n\n                /**\n                 * скрываем все поповеры,\n                 * кроме актуальной\n                 */\n                PopoverControl._closeAllOtherPopovers($('.add-settings.active'), $popover);\n\n                /**\n                 * деактивируем все триггер-кнопки,\n                 * кроме той, по которой щас кликнули\n                 */\n                PopoverControl._closeAllOtherTriggerButtons($('.obj-img__wrapper.active'), $triggerButton);\n\n                $popover.toggleClass('active');\n                $triggerButton.toggleClass('active');\n\n                /**\n                 * позиционируем поповер\n                 */\n                PopoverControl._positioning($triggerButton, $popover);\n\n                /**\n                 * навешиваем дополнительные события\n                 * (для скрытия попапа и т.д.)\n                 */\n                PopoverControl._additionalEvents($triggerButton, $popover);\n            });\n        });\n    }\n\n    /**\n     *\n     * @param $popovers[] {object}\n     * @param $popoverActual {object}\n     * @private\n     */\n    static _closeAllOtherPopovers ($popovers, $popoverActual) {\n        $popovers.each(function () {\n            if ($(this)[0] !== $popoverActual[0]) $(this).removeClass('active');\n        });\n    }\n\n    /**\n     *\n     * @param $triggerButtons[] {object}\n     * @param $triggerButtonActual {object}\n     * @private\n     */\n    static _closeAllOtherTriggerButtons ($triggerButtons, $triggerButtonActual) {\n        $triggerButtons.each(function () {\n            if ($(this)[0] !== $triggerButtonActual[0]) $(this).removeClass('active');\n        });\n    }\n\n    /**\n     *\n     * @param $triggerButton {object}\n     * @param $popover {object}\n     * @private\n     */\n    static _additionalEvents ($triggerButton, $popover) {\n        /**\n         * убираем всплытие события клик у поповера,\n         * чтобы он не закрывался при нём\n         */\n        setTimeout(function () {\n            $popover.on('click', function (e) {\n                e.stopPropagation();\n            });\n        }, 0);\n\n        /**\n         * клик в любом месте документа,\n         * кроме самого этого элемента\n         * скроет поповер\n         */\n        setTimeout(function () {\n            $(document).one('click', function () {\n                PopoverControl.close($triggerButton, $popover);\n            });\n        }, 0);\n    }\n\n    /**\n     *\n     * @param $triggerButton {object}\n     * @param $popover {object}\n     */\n    static close ($triggerButton, $popover) {\n        $popover.removeClass('active');\n        $popover.off('click');\n        $triggerButton.removeClass('active');\n    }\n\n    /**\n     *\n     * @param $triggerButton {object}\n     * @param $popover {object}\n     * @private\n     */\n    static _positioning ($triggerButton, $popover) {\n        /**\n         * сбрасываем все изменения,\n         * чтобы позиционирование сработало нормально.\n         * скрываем элемент на время позиционирования.\n         *\n         */\n        PopoverControl._positioningBefore($popover);\n\n        /**\n         *\n         * получаем координаты всех нужных объектов\n         */\n        let coords = PopoverControl._getCoords($triggerButton, $popover);\n\n        /**\n         *\n         * transform работает гораздо быстрее всяких margin,\n         * потому что браузер не перерисовывает DOM-дерево\n         */\n\n        let top = Math.abs(parseInt(coords.$popoverBottom.bottom - coords.$popover.top));\n\n        $popover.css({'transform' : 'translateY(-' + top + 'px)'});\n\n        /**\n         * если правая точка поповера заходит\n         * на край блока с текстом, двигаем его назад + небольшой отступ.\n         * аналогично с левой точкой\n         */\n        if (coords.$popover.right >= coords.$text.right) {\n            let right = Math.abs(parseInt(coords.$popover.right - coords.$text.right + 10 /*padding-right*/));\n\n            $popover.css({'transform' : 'translate(-' + right + 'px, ' + '-' + top + 'px)'});\n        } else if (coords.$popover.left <= coords.$text.left) {\n            let left = Math.abs(parseInt(coords.$popover.left - coords.$text.left + 10 /*padding-left*/));\n\n            $popover.css({'transform' : 'translate(' + left + 'px, ' + '-' + top + 'px)'});\n        }\n\n        /**\n         *\n         * после того как поповер был сдвинут,\n         * координаты его нижней части были измененеы,\n         * их нужно актуализировать, ещё раз получив их\n         */\n        coords.$popoverBottom = $popover.find('.add-settings__bottom')[0].getBoundingClientRect();\n\n        /**\n         * зеркалим нижнюю часть поповера,\n         * если триггер-кнопка правее его\n         */\n        let $addSettingsBottom = $popover.find('.add-settings__bottom');\n\n        if ((coords.$popoverBottom.left - parseInt($addSettingsBottom.css('left'))) < coords.$triggerButton.left) {\n            $addSettingsBottom.addClass('revert');\n        }\n\n        /**\n         * когда позиционирование было завершено,\n         * проявляем элемент\n         */\n        PopoverControl._positioningAfter($popover);\n    }\n\n    /**\n     *\n     * @param $popover {object}\n     * @private\n     */\n    static _positioningBefore ($popover) {\n        $popover.css({\n            'transform' : 'translate(0, 0)',\n            'opacity' : '0'\n        });\n\n        let $addSettingsBottom = $popover.find('.add-settings__bottom');\n        $addSettingsBottom.removeClass('revert');\n    }\n\n    /**\n     *\n     * @param $triggerButton {object}\n     * @param $popover {object}\n     * @private\n     */\n    static _getCoords ($triggerButton, $popover) {\n        const constsDom = ConstsDom.get();\n\n        return {\n            $popover: $popover[0].getBoundingClientRect(),\n            $triggerButton: $triggerButton[0].getBoundingClientRect(),\n            $text: constsDom.$text[0].getBoundingClientRect(),\n            //$text: $('.text')[0].getBoundingClientRect(),\n            $popoverBottom: $popover.find('.add-settings__bottom')[0].getBoundingClientRect()\n        };\n    }\n\n    /**\n     *\n     * @param $popover {object}\n     * @private\n     */\n    static _positioningAfter ($popover) {\n        $popover.css({\n            'opacity' : ''\n        });\n    }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./new_view/js/custom/PopoverControl.js\n// module id = 1\n// module chunks = 0","import ConstsDom from './ConstsDOM';\nimport PopoverControl from './PopoverControl';\n\n$(window).load(function () {\n    const constDom = ConstsDom.get();\n\n    //customScrollBar\n    $('.js-scrollable-item').mCustomScrollbar({\n        theme: 'activeBook-default',\n        autoDraggerLength: true,\n        mouseWheel: {scrollAmount: 75},\n        scrollbarPosition: 'outside'\n    });\n\n    //ionRangeSlider\n    $('.js-range-slider').ionRangeSlider({\n        min: 0,\n        max: 100,\n        from: 50,\n        hide_min_max: true,\n        hide_from_to: true\n    });\n\n    //отображаем доп. меню для элементов с поповером\n    PopoverControl.init($('.menu__item').has('.add-settings'));\n\n    //переключалка для вибрации\n    //todo: если включаем - то давать короткую вибрацию\n    $('.js-vibration-toggle').find('.add-settings__item__toggle__item').on('click', function () {\n       let $parent = $(this).closest('.add-settings__item__toggle');\n\n       if (!$(this).hasClass('active')) {\n           $parent.find('.add-settings__item__toggle__item').removeClass('active');\n           $(this).addClass('active');\n       }\n    });\n\n    //переключалка темы оформления\n    $('.add-settings__item__theme-option').on('click', function () {\n        let $parent = $(this).closest('.add-settings__item.theme-options');\n\n        if (!$(this).hasClass('active')) {\n            $parent.find('.add-settings__item__theme-option').removeClass('active');\n            $(this).addClass('active');\n        }\n    });\n\n    //оглавление\n    $('.js-table-of-contents-show').on('click', function () {\n       constDom.$text.hide();\n       constDom.$tableOfContents.show();\n       PopoverControl.close($(this).closest('.menu__item'), $(this).closest('.add-settings'));\n    });\n\n    $('.js-table-of-contents-close').on('click', function () {\n        constDom.$tableOfContents.hide();\n        constDom.$text.show();\n    });\n\n    //клик по элементу оглавления (главе)\n    $('.table-of-contents__item').on('click', function () {\n       let pageNumber = $.trim($(this).find('.table-of-contents__item__page').text());\n\n       //todo: потом заменить на настоящий переход на страницу\n       console.log(pageNumber);\n    });\n\n    //меняем межстрочный интервал\n    //todo: добавить реальное изменение интервала\n    $('.js-line-height-minus').on('click', function () {\n        let $val = $('.js-line-height-val');\n        let currentVal = parseInt($val.text());\n        let newVal = currentVal - 25;\n\n        if (currentVal <= 50) newVal = 50;\n\n        $val.text(newVal + '%');\n    });\n\n    $('.js-line-height-plus').on('click', function () {\n        let $val = $('.js-line-height-val');\n        let currentVal = parseInt($val.text());\n        let newVal = currentVal + 25;\n\n        if (currentVal >= 150) newVal = 150;\n\n        $val.text(newVal + '%');\n    });\n\n    //меняем страницу\n    //todo: потом заменить на настоящий переход на страницу\n    $('.js-page-next').on('click', function () {\n        let $val = $('.js-page-number');\n        let currentVal = parseInt($val.attr('data-page-number'));\n        let pagesLength = parseInt($val.attr('data-pages-length'));\n        let newVal = currentVal + 1;\n\n        if (currentVal >= pagesLength) newVal = currentVal;\n        if (newVal.toString().length < 3) {\n            for (let i = 1; i < 3; i++) {\n                if (('0'.repeat(i) + newVal).length === 3) {\n                    newVal = '0'.repeat(i) + newVal;\n                    break;\n                }\n            }\n        }\n\n        $val.find('input').val(newVal);\n    });\n\n    $('.js-page-prev').on('click', function () {\n        let $val = $('.js-page-number');\n        let currentVal = parseInt($val.attr('data-page-number'));\n        let newVal = currentVal - 1;\n\n        if (currentVal <= 1) newVal = currentVal;\n        if (newVal.toString().length < 3) {\n            for (let i = 1; i < 3; i++) {\n                if (('0'.repeat(i) + newVal).length === 3) {\n                    newVal = '0'.repeat(i) + newVal;\n                    break;\n                }\n            }\n        }\n\n        $val.find('input').val(newVal);\n    });\n\n    $('.js-page-number').find('input').on('blur', function () {\n        let $val = $('.js-page-number');\n        let currentVal = parseInt($val.attr('data-page-number'));\n        let pagesLength = parseInt($val.attr('data-pages-length'));\n        let pattern = $val.find('input').attr('pattern');\n        let newVal = $(this).val();\n\n        if (newVal.length === 0) return;\n\n        //only numbers allows\n        if (new RegExp('^' + pattern + '+$').test(newVal) === false) {\n            $(this).css({'background': 'red'});\n            $(this).val('');\n\n            $(this).one('keydown', function () {\n                $(this).css({'background': ''});\n            });\n\n            return;\n        }\n\n        newVal = Math.abs(parseInt(newVal));\n\n        if (newVal <= 1) {\n            newVal = 1;\n        } else if (newVal >= pagesLength) {\n            newVal = pagesLength;\n        }\n\n        if (newVal === currentVal) return;\n\n        console.log(newVal);\n    });\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./new_view/js/custom/js.js\n// module id = 2\n// module chunks = 0"],"sourceRoot":""}